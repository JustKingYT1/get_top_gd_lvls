name: –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Demonlist

on:
  schedule:
    - cron: '0 5 * * *' # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 5 —É—Ç—Ä–∞ –ø–æ UTC
  workflow_dispatch: # –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

jobs:
  scrape:
    runs-on: ubuntu-latest
    steps:
      # –®–∞–≥ 1: –°–∫–∞—á–∏–≤–∞–µ–º –∫–æ–¥ –∏–∑ —Ç–≤–æ–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
      - name: Checkout repository
        uses: actions/checkout@v3

      # –®–∞–≥ 2: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Python
      - name: Set up Python 3.11
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      # –®–∞–≥ 3: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –Ω—É–∂–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
      - name: Install dependencies
        run: pip install -r requirements.txt

      # –®–∞–≥ 4: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä—ã –¥–ª—è Playwright
      - name: Install Playwright browsers and dependencies
        run: playwright install --with-deps

      # –®–∞–≥ 5 (–ò–°–ü–†–ê–í–õ–ï–ù–û): –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—à –≥–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
      - name: Run data scraper
        run: python update_data.py

      # –®–∞–≥ 6 (–î–û–ë–ê–í–õ–ï–ù–û): –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–º–º–∏—Ç–∏–º –∏ –ø—É—à–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö
      - name: Commit and push if data changed
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "chore(auto): üîÑ –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö Demonlist"
          
          file_pattern: data/demonlist.json